package de.uol.pgdoener.th1.application.infrastructure.converterchain.core.converter;

import de.uol.pgdoener.th1.application.converterchain.converter.TransposeMatrixConverter;
import de.uol.pgdoener.th1.application.dto.TransposeMatrixStructureDto;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

public class TransposeMatrixConverterTest {

    @Test
    void testHandleRequest() {
        TransposeMatrixStructureDto structure = new TransposeMatrixStructureDto();
        TransposeMatrixConverter transposeConverter = new TransposeMatrixConverter(structure);

        String[][] matrix = {
                {"Gegenstand der Nachweisung", "2021", "2022", "2025", "2030", "2035", "2040", "2045", "2050", "2055", "2060"},
                //{"", "Anzahl", "", "", "", "", "", "", "", ""},
                {"Bevölkerung", "11.124.642", "11.125.983", "11.170.102", "11.263.812", "11.347.776", "11.421.421", "11.476.228", "11.511.243", "11.538.460", "11.576.523"},
                //{"von … bis unter … Jahren", "", "", "", "", "", "", "", "", ""},
                {"unter 50", "6.305.201", "6.287.364", "6.308.847", "6.352.332", "6.358.646", "6.333.915", "6.318.217", "6.326.512", "6.349.482", "6.371.310"},
                {"50–60", "1.726.379", "1.690.196", "1.541.396", "1.383.189", "1.407.983", "1.463.579", "1.481.922", "1.466.207", "1.452.900", "1.446.591"},
                {"60–70", "1.398.493", "1.437.922", "1.557.844", "1.614.177", "1.442.246", "1.311.970", "1.343.159", "1.391.693", "1.406.192", "1.396.059"},
                {"70–80", "918.605", "932.654", "1.002.293", "1.147.416", "1.316.157", "1.367.814", "1.236.446", "1.142.759", "1.172.029", "1.221.288"},
                {"80–90", "666.609", "671.296", "640.833", "604.053", "672.352", "779.772", "896.998", "938.981", "859.840", "819.544"},
                {"90 und mehr", "109.355", "106.551", "118.889", "162.645", "150.392", "164.371", "199.487", "245.090", "298.017", "321.732"},
                {"Pflegebedürftige", "540.401", "547.359", "570.352", "596.682", "624.679", "673.560", "728.173", "774.887", "798.141", "800.776"},
                //{"von … bis unter … Jahren", "", "", "", "", "", "", "", "", ""},
                {"unter 50", "63.441", "63.462", "64.187", "65.300", "65.481", "65.027", "64.560", "64.558", "64.850", "65.165"},
                {"50–60", "28.584", "28.145", "25.920", "22.810", "23.041", "23.978", "24.359", "24.100", "23.886", "23.743"},
                {"60–70", "50.031", "51.397", "55.922", "59.223", "54.035", "48.188", "48.890", "50.735", "51.519", "51.163"},
                {"70–80", "94.859", "95.735", "103.006", "117.919", "135.615", "145.105", "134.218", "120.747", "122.785", "128.253"},
                {"80–90", "221.796", "228.788", "233.200", "211.030", "231.610", "268.398", "307.176", "332.260", "312.363", "289.337"},
                {"90 und mehr", "81.690", "79.831", "88.116", "120.400", "114.896", "122.864", "148.969", "182.487", "222.737", "243.115"},
                {"männlich", "207.294", "209.748", "218.562", "229.152", "240.569", "258.292", "282.344", "299.710", "309.673", "313.015"},
                {"weiblich", "333.107", "337.611", "351.790", "367.530", "384.110", "415.268", "445.829", "475.177", "488.468", "487.761"},
                //{"Versorgungsart", "", "", "", "", "", "", "", "", "", ""},
                {"ambulant", "93.597", "95.035", "99.898", "104.833", "110.177", "120.590", "133.322", "144.453", "150.219", "150.814"},
                {"vollstationär", "91.759", "92.852", "98.197", "105.533", "110.584", "119.820", "133.501", "146.767", "156.299", "159.534"},
                {"Pflegegeld", "291.159", "294.783", "305.769", "318.300", "332.278", "355.884", "379.631", "399.335", "407.816", "407.746"},
                {"Sonstige", "63.886", "64.689", "66.487", "68.017", "71.640", "77.266", "81.719", "84.332", "83.806", "82.682"},
                {"Beschäftigte", "145.606", "147.455", "155.651", "166.202", "174.307", "189.388", "210.623", "230.647", "244.079", "248.054"},
                {"ambulant", "40.052", "40.648", "42.704", "44.820", "47.080", "51.479", "57.051", "61.814", "64.282", "64.536"},
                {"stationär", "105.554", "106.806", "112.947", "121.382", "127.227", "137.909", "153.572", "168.832", "179.797", "183.518"}
        };

        String[][] expected = {
                {"Gegenstand der Nachweisung", "Bevölkerung", "unter 50", "50–60", "60–70", "70–80", "80–90", "90 und mehr", "Pflegebedürftige", "unter 50", "50–60", "60–70", "70–80", "80–90", "90 und mehr", "männlich", "weiblich", "ambulant", "vollstationär", "Pflegegeld", "Sonstige", "Beschäftigte", "ambulant", "stationär"},
                {"2021", "11.124.642", "6.305.201", "1.726.379", "1.398.493", "918.605", "666.609", "109.355", "540.401", "63.441", "28.584", "50.031", "94.859", "221.796", "81.690", "207.294", "333.107", "93.597", "91.759", "291.159", "63.886", "145.606", "40.052", "105.554"},
                {"2022", "11.125.983", "6.287.364", "1.690.196", "1.437.922", "932.654", "671.296", "106.551", "547.359", "63.462", "28.145", "51.397", "95.735", "228.788", "79.831", "209.748", "337.611", "95.035", "92.852", "294.783", "64.689", "147.455", "40.648", "106.806"},
                {"2025", "11.170.102", "6.308.847", "1.541.396", "1.557.844", "1.002.293", "640.833", "118.889", "570.352", "64.187", "25.920", "55.922", "103.006", "233.200", "88.116", "218.562", "351.790", "99.898", "98.197", "305.769", "66.487", "155.651", "42.704", "112.947"},
                {"2030", "11.263.812", "6.352.332", "1.383.189", "1.614.177", "1.147.416", "604.053", "162.645", "596.682", "65.300", "22.810", "59.223", "117.919", "211.030", "120.400", "229.152", "367.530", "104.833", "105.533", "318.300", "68.017", "166.202", "44.820", "121.382"},
                {"2035", "11.347.776", "6.358.646", "1.407.983", "1.442.246", "1.316.157", "672.352", "150.392", "624.679", "65.481", "23.041", "54.035", "135.615", "231.610", "114.896", "240.569", "384.110", "110.177", "110.584", "332.278", "71.640", "174.307", "47.080", "127.227"},
                {"2040", "11.421.421", "6.333.915", "1.463.579", "1.311.970", "1.367.814", "779.772", "164.371", "673.560", "65.027", "23.978", "48.188", "145.105", "268.398", "122.864", "258.292", "415.268", "120.590", "119.820", "355.884", "77.266", "189.388", "51.479", "137.909"},
                {"2045", "11.476.228", "6.318.217", "1.481.922", "1.343.159", "1.236.446", "896.998", "199.487", "728.173", "64.560", "24.359", "48.890", "134.218", "307.176", "148.969", "282.344", "445.829", "133.322", "133.501", "379.631", "81.719", "210.623", "57.051", "153.572"},
                {"2050", "11.511.243", "6.326.512", "1.466.207", "1.391.693", "1.142.759", "938.981", "245.090", "774.887", "64.558", "24.100", "50.735", "120.747", "332.260", "182.487", "299.710", "475.177", "144.453", "146.767", "399.335", "84.332", "230.647", "61.814", "168.832"},
                {"2055", "11.538.460", "6.349.482", "1.452.900", "1.406.192", "1.172.029", "859.840", "298.017", "798.141", "64.850", "23.886", "51.519", "122.785", "312.363", "222.737", "309.673", "488.468", "150.219", "156.299", "407.816", "83.806", "244.079", "64.282", "179.797"},
                {"2060", "11.576.523", "6.371.310", "1.446.591", "1.396.059", "1.221.288", "819.544", "321.732", "800.776", "65.165", "23.743", "51.163", "128.253", "289.337", "243.115", "313.015", "487.761", "150.814", "159.534", "407.746", "82.682", "248.054", "64.536", "183.518"}
        };

        String[][] result = transposeConverter.handleRequest(matrix);
        Assertions.assertArrayEquals(expected, result);

    }


}
